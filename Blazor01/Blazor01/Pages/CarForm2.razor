@using System.Net.Http
@inject HttpClient Http
@using System.Net.Http.Json
@using System.Threading.Tasks
@using tradehub.Domain.Model

@page "/car2"

<h3>Добавление нового автомобиля</h3>

    <div>
        <label for="Name">Название:</label>
        <input id="Name" @bind="newCar.Name" placeholder="Название автомобиля" />
    </div>

    <div>
        <label for="VIN">VIN:</label>
        <input id="VIN" @bind="newCar.VIN" placeholder="VIN автомобиля" />
    </div>

    <div>
        <label for="Status">Статус:</label>
        <input id="Status" @bind="newCar.Status" placeholder="Статус автомобиля" />
    </div>

    <button @onclick="AddCar">Добавить новый автомобиль</button>

    <div style="color:red;" float="left">@message</div>


@code {
    string message = "";
    private Car newCar = new Car();
    private int? createdCarId; // Используем Nullable<int> для хранения ID

    private async Task AddCar()
    {
        var response = await Http.PostAsJsonAsync("https://localhost:7225/api/Car", newCar);
        if (response.IsSuccessStatusCode)
        {
            var AddCar = await response.Content.ReadFromJsonAsync<Car>();
            if (AddCar != null) message = $"Создан объект Person с id = {AddCar.Id}";
        }
        else
        {
            var error = await response.Content.ReadFromJsonAsync<Error>();
            if (error != null) message = error.Details;
        }
    }

      class Error
    {
        public string Details { get; set; } = "";
    }


}


  